<!DOCTYPE html>
<html>

	<head>

		<script src="js/angular-0.9.12.min.js" ng:autobind></script>

		<script>
			ChangesetsController.$inject = ['$resource'];
			function ChangesetsController($resource) {
				this.ChangesetsResource = $resource(
					'/changesets',
					{ callback: 'JSON_CALLBACK' },
					{ get: { method: 'JSON' } }
				);
			}

			ChangesetsController.prototype = {
				fetchWithMessageContaining: function() {
					this.result = this.ChangesetsResource.get({ with_message_containing: this.messagePart });
				},

				fetchWithPathEndingOn: function() {
					this.result = this.ChangesetsResource.get({ with_path_ending_on: this.pathEnd });
				}
			};
		</script>

	</head>
	
	<body>

		<div ng:controller="ChangesetsController">
			<div class="searchform">
				<div class="message">
					Show changesets with message containing:
					<input name="messagePart" value="Hello World"/>
					<button ng:click="fetchWithMessageContaining()">Find</button>
				</div>
				<div class="path">
					Show changesets with at least one path ending on:
					<input name="pathEnd" value="index.php"/>
					<button ng:click="fetchWithPathEndingOn()">Find</button>
				</div>
			</div>
			<hr/>
			<div class="searchresults">
				<div class="searchresult" ng:repeat="changeset in result.changesets">
					<div class="changeset metadata">
						<div class="revision">
							<span class="label">Revision:</span>
							<span class="value">{{changeset.sRevisionNumber}}</span>
						</div>
						<div class="author">
							<span class="label">Author:</span>
							<span class="value">{{changeset.sAuthor}}</span>
						</div>
						<div class="datetime">
							<span class="label">Date and time of commit:</span>
							<span class="value">{{changeset.sDateTime}}</span>
						</div>
						<div class="message">
							<span class="label">Message:</span>
							<div class="value">{{changeset.sMessage}}</div>
						</div>
					</div>
					<div class="changeset pathoperations">
						<div class="pathoperation" ng:repeat="aPathoperation in changeset.aaPathoperations">
							<div class="action">{{aPathoperation.sAction}}</div>
							<div class="path">{{aPathoperation.sPath}}</div>
						</div>
					</div>
				</div>
			</div>
		</div>

	</body>

</html>
